<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">



    <h:body>

        <ui:composition template="./../template/mainTemplate.xhtml">


            <ui:define name="content">

                <style>

                    @font-face{
                        font-family: 'Garlic Sans';
                        font-weight: normal;
                        font-style: normal;
                        src: url('../resources/fonts/Garlic-Sans-Regular.ttf')format('truetype');
                    }
                    @font-face{
                        font-family: 'Typo Round Bold Demo';
                        font-weight: normal;
                        font-style: normal;
                        src: url('../resources/fonts/Typo_Round_Bold_Demo.otf')format('truetype');
                    }

                    .general{
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        width: 85%;
                        margin-top: 50px;
                        background-color: wheat;
                        margin-left: 7.5%;


                    }


                    .contenidos{
                        margin: 30px;

                    }

                    .titulo{

                        text-align: center;
                        background-color: lightgray;
                        color:black;
                        padding: 0px;
                        margin: 0px;
                        font-size: 50px;

                        font-family: Garlic Sans;


                    }

                    .subtitulo{

                        text-align: center;
                        background-color: lightgray;
                        color:black;
                        padding: 0px;
                        margin: 0px;
                        font-size: 30px;
                        width: 40%;

                        font-family: Garlic Sans;


                    }


                    .prg{
                        color: black;
                        background-color: white;
                        margin: 5px;
                        width: 580px;
                    }

                    .content{

                        margin: 20px;
                    }

                    .outl{
                        color: black;
                        font-size: 50px;
                        margin: 20px;
                    }

                    .out{
                        font-family: Garlic Sans;
                        font-size: 20px;
                        width: 300px;
                        height: 20%;

                    }

                    .sig{
                        font-size: 20px;
                        font-weight: bold;
                        float:right;
                        margin:20px;
                    }

                    .ui-inputgroup-addon{
                        font-size: 50px;
                    }

                    .outN{

                        font-family: Garlic Sans;
                        font-size: 20px;
                    }

                    .outB{
                        color: #ffffff;
                        font-size: 20px;
                        margin-left: 10px;
                    }

                    .inB{
                        margin: 20px;
                    }

                    .bar{
                        background-color:rgb(61, 110, 56); 
                        color: white;
                    }

                    .edit{
                        background-color:rgb(61, 110, 56); 
                        margin-bottom: 10px;
                    }
                    .ui-datatable {
                        border-bottom: 0 none;
                        font-family: Garlic Sans;

                    }
                    .menuI{
                        width: 40%;
                        margin-left: 30%;

                    }
                    .cat{
                        margin-top: 20px;
                    }
                    .ui-datatable-header {
                        border-bottom: 0 none;
                        background-color: darkgreen;
                        font-size: 26px;
                    }
                    .ui-datatable thead th, .ui-datatable tfoot td {
                        text-align: center;
                        background-color: rgba(152,250,128,0.9); 
                        font-size: 22px;
                    }
                    .ui-widget-content {
                        border: 1px solid #a8a8a8;
                        background-color: rgba(152,210,128,0.8); 
                        color: #4f4f4f;
                        font-size: 20px;
                    }
                    .ui-orderlist .ui-orderlist-item {
                        cursor: pointer;

                        font-weight: inherit;
                    }
                    .ui-orderlist-list, .ui-orderlist.ui-grid-responsive .ui-orderlist-caption {
                        font-family: Garlic Sans;
                        background-color: rgba(152,210,128,1); 
                        font-size: 24px;
                    }
                    .ui-orderlist.ui-grid-responsive .ui-orderlist-controls .ui-button {
                        display: inline;
                        width: 20%;
                        font-family: Garlic Sans;
                        background-color: rgba(152,210,128,0.8); 

                    }


                    .ui-orderlist .ui-orderlist-list li {
                        margin: 1px;
                        padding: 2px;
                        border: 0.5px solid darkgreen;
                    }
                    .ql-toolbar.ql-snow {
                        display:none;
                    }
                    .ql-container {
                        font-family: Garlic Sans;
                        font-size: 22px;
                    }
                    .ui-md-10 {
                        width: 100%;
                    }
                    .ui-selectonelistbox .ui-selectlistbox-item, .ui-selectmanymenu .ui-selectlistbox-item, .ui-multiselectlistbox .ui-multiselectlistbox-item {
                        cursor: pointer;
                        font-weight: normal;
                        font-family: Garlic Sans;
                        background-color: rgba(152,210,128,0.8); 
                    }


                    .td {
                        display: table-cell;
                        vertical-align: inherit;
                        font-family: Garlic Sans;
                    }

                    .btt {
                        margin-bottom: 5px;
                    }

                    .text {
                        color: #ffffff;
                        background-color: rgb(61, 110, 56);   
                        height: 270px;
                        font-family: Garlic Sans;
                    }
                    .col1{
                        width: 70%;
                    }
                    .col2{
                        width: 30%;
                    }

                </style>


                <p:sidebar class="bar2" id="bb" widgetVar="sidebar5" fullScreen="true" baseZIndex="10000"  >

                    <h:form>

                        <p:dataTable var="recipes_ingredients" value="#{editRecipeControler.listRI}">

                            <p:column class ="cabeceras" headerText="Ingrediente">
                                <h:outputText value="#{editRecipeControler.selectedIngredients.get(recipes_ingredients.ingredients).name}" />
                            </p:column>

                            <p:column class="cabeceras" headerText="Cantidad (en gramos)">  
                                <p:inputNumber decimalPlaces="0"  id="input1"  value="#{recipes_ingredients.ammount}" symbol=" g" symbolPosition="s" />
                            </p:column>

                        </p:dataTable>

                        <p:commandButton  class="bttBAR" value="Confirmar cantidades" actionListener="#{editRecipeControler.insertNewIngredients()}" oncomplete="PF('sidebar5').hide()" update="message" ajax="false"/>

                    </h:form>
                </p:sidebar>



                <p:growl id="message" showDetail="true" />


                <div class="general">


                    <div class="contenidos">




                        <div class="titulo">

                            EDITAR IMAGEN 

                        </div>


                        <h:form id="welcomeForm" enctype="multipart/form-data">
                            <h:panelGrid style="margin-top: 20px; width: 100%;" class="fondoverde" columnClasses="col1,col2" columns="2" >




                                <p:graphicImage value="#{editRecipeControler.image}"  stream="false" style=" width: 100%; height: 100%"/>
                                <h:panelGrid style="width: 100%;" class="fondoverde" columnClasses="col1,col2" columns="1" >

                                    <p:fileUpload  class="bi" style="margin-left: 5%" label="Selecciona una imagen nueva" value="#{editRecipeControler.file}" mode="simple"  skinSimple="true" allowTypes="/(\.|\/)(gif|jpe?g|png)$/"/>
                                    <br/>
                                    <br/>
                                    <br/>
                                    <br/>

                                    <p:commandButton style="margin-left: 20%" value="Cambiar Imagen" action="#{editRecipeControler.editImage()}" update="message" ajax="false"/>
                                </h:panelGrid>



                            </h:panelGrid>
                        </h:form>

                        <br/>
                        <br/>
                        <br/>

                        <div class="titulo">

                            EDITAR INGREDIENTES

                        </div>
                        <br/>
                        <br/>
                        <div class="subtitulo">
                            Eliminar ingredientes:
                        </div>

                        <br/>

                        <h:form>

                            <p:dataTable class="cat" var="ingredient" value="#{editRecipeControler.ingredientsList}" selection="#{editRecipeControler.ingredient}" selectionMode="single" rowKey="#{ingredient.name}">


                                <f:facet name="header">
                                    Ingredientes
                                </f:facet>

                                <p:column class ="cabeceras" headerText="Nombre del ingrediente">
                                    <h:outputText value="#{ingredient.name}" />
                                </p:column>

                                <p:column class="cabeceras" headerText="Cantidad en Gramos">  
                                    <h:outputText value="#{ingredient.quantity}" >
                                        <f:convertNumber pattern="#0" />
                                    </h:outputText>
                                </p:column>



                                <p:column class="cabeceras" headerText="">  

                                    <p:commandButton value="Eliminar" action="#{editRecipeControler.deleteIngredient(ingredient)}" update="message" ajax="false"/>
                                </p:column>




                            </p:dataTable>
                        </h:form>
                        <br/>
                        <br/>
                        <br/>
                        <div class="subtitulo">
                            Añadir ingredientes:
                        </div>
                        <h:form>
                            <div class="ingredients">



                                <p:growl id="message" showDetail="true" />
                                <br/>


                                <p:selectManyMenu class="menuI" value="#{editRecipeControler.selectedIngredients}"
                                                  var="t" filter="true" filterMatchMode="contains" showCheckbox="true">
                                    <f:selectItems value="#{editRecipeControler.ingredients}" var="theme" itemLabel="#{ingredients.name}" itemValue="#{ingredients}" />
                                    <p:column>
                                        <h:outputText value="#{t.name}" />
                                    </p:column>
                                </p:selectManyMenu>
                                <br/>
                                <br/>
                                <p:commandButton style="margin-left: 45%" value="Agregar" actionListener="#{editRecipeControler.prepararTabla()}" update="bb" oncomplete="PF('sidebar5').show()"/>



                            </div>

                        </h:form>

                        <br/>
                        <br/>
                        <br/>


                        <br/>
                        <br/>
                        <div class="titulo">

                            EDITAR PASOS

                        </div>
                        <br/>
                        <br/>
                        <br/>
                        <div class="subtitulo">
                            Borrar pasos: 
                        </div>
                        <br/>
                        <br/>



                        <h:form>


                            <p:dataTable class="cat" var="stepp" value="#{editRecipeControler.stepsList2}" selection="#{editRecipeControler.step}" selectionMode="single" rowKey="#{stepp.title}">




                                <f:facet name="header">
                                    Borrar pasos
                                </f:facet>

                                <p:column class ="cabeceras" headerText="Nombre de la receta">
                                    <h:outputText value="#{stepp.title}" />
                                </p:column>

                                <p:column class="cabeceras" headerText="Cantidad">  
                                    <h:outputText value="#{stepp.description}" >
                                        <f:convertNumber pattern="#0" />
                                    </h:outputText>
                                </p:column>



                                <p:column class="cabeceras" headerText="">  

                                    <p:commandButton value="Eliminar" action="#{editRecipeControler.deleteStep(stepp)}" update="message" ajax="false" />
                                </p:column>




                            </p:dataTable>

                        </h:form>

                        <br/>
                        <br/>
                        <br/>
                        <div class="subtitulo">
                            Cambiar orden de los pasos: 
                        </div>
                        <br/>

                        <br/>
                        <br/>
                        <h:form>


                            <p:orderList value="#{editRecipeControler.stepsList}" var="step" itemValue="#{step.id}"  controlsLocation="null" responsive="true" >


                                <f:facet name="caption">Mueve los pasos para cambiar de orden y confirma con el botón</f:facet>

                                <p:column style="width:30%">
                                    <h:outputText value="#{step.title}" />
                                </p:column>


                            </p:orderList>
                            <br/>
                            <br/>
                            <p:commandButton value="Confirmar el nuevo orden" actionListener="#{editRecipeControler.setNewOrder()}" style="margin-left: 40%;font-size: 34px;margin-top:5px" update="message"  />

                        </h:form>


                        <br/>
                        <br/>
                        <br/>
                        <br/>
                        <div class="subtitulo">
                            Añadir nuevos pasos: 
                        </div>
                        <br/>

                        <br/>
                        <br/>




                        <div class="steps">

                            <h:form>

                                <p:growl id="message" showDetail="true" />

                                <h:outputText class="out" value="Breve descripcion del paso: "/>
                                <p:inputText id ="titulo" class="in" value="#{editRecipeControler.steptoCreate.title}" required="true" label="Titulo" widgetVar="editor2"/>

                                <br/>
                                <br/>
                                <p:textEditor id="tx" class="text" style="font-family: Garlic Sans;" widgetVar="editor2" value="#{editRecipeControler.steptoCreate.description}" placeholder="Describa el procedimiento a realizar en este paso.">
                                    <f:facet name="toolbar"><span class="ql-formats"/></f:facet>
                                </p:textEditor>

                                <br/>
                                <br/>
                                <br/>
                                <p:commandButton class="btt" value="Añadir paso" action="#{editRecipeControler.insertSteps()}" style="margin-left: 45%;font-size: 34px;margin-top:5px" update="message" ajax="false" />



                            </h:form>  

                        </div>




                    </div>
                </div>

            </ui:define>

        </ui:composition>

    </h:body>
</html>
